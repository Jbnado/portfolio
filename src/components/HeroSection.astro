---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import StatCard from './StatCard.astro';
import StatsCounter from '../islands/StatsCounter.tsx';
import { t } from '../i18n/utils';
import gonImg from '../assets/imgs/Gon-full-body-hi.webp';
import skullRockImg from '../assets/imgs/skull-rockandroll.webp';
import flamingSkullImg from '../assets/imgs/flaming-skull.webp';

interface Props {
  locale?: string;
}

const { locale = 'pt-br' } = Astro.props;

const statsEntries = await getCollection('stats');
const statsData = statsEntries[0]?.data?.items ?? [];

const techStack = ['React', 'Node.js', 'TypeScript', 'Java', 'Python', 'AWS'];
const techString = techStack.join(' Â· ');
---

<section id="hero" class="hero-section">
  <!-- PUNK: Gon â€” huge, top-right corner -->
  <Image src={gonImg} alt="" width={400} format="webp" quality={80}
    class="punk-sticker" style="width:260px;top:-2%;right:1%;--punk-rotate:-8deg;animation-delay:0s;opacity:0.9" />

  <!-- PUNK: Skull Rock&Roll â€” mid-left -->
  <Image src={skullRockImg} alt="" width={240} format="webp" quality={75}
    class="punk-sticker" style="width:120px;top:5%;left:2%;--punk-rotate:12deg;animation-delay:1.5s" />

  <!-- PUNK: Flaming skull â€” bottom-left -->
  <Image src={flamingSkullImg} alt="" width={180} format="webp" quality={75}
    class="punk-sticker" style="width:90px;bottom:15%;left:3%;--punk-rotate:-15deg;animation-delay:2.2s" />

  <!-- PUNK: Menacing gogo â€” fewer, spread out -->
  <span class="punk-menacing" style="top:6%;left:18%;font-size:1.5rem;color:rgba(162,119,255,0.2);--punk-rotate:-18deg" aria-hidden="true">gogo</span>
  <span class="punk-menacing" style="top:40%;right:28%;font-size:2rem;color:rgba(97,255,202,0.1);--punk-rotate:-5deg;animation-delay:3s" aria-hidden="true">gogo</span>

  <!-- PUNK: BOOM + stars â€” spread out, not competing -->
  <span class="punk-ono" style="top:8%;right:24%;font-size:2.5rem;color:#f694ff;transform:rotate(12deg);text-shadow:0 0 20px rgba(246,148,255,0.5)" aria-hidden="true">BOOM!</span>
  <span class="punk-ono" style="bottom:12%;right:5%;font-size:2rem;color:#61ffca;text-shadow:0 0 15px rgba(97,255,202,0.5)" aria-hidden="true">&#9733;</span>
  <span class="punk-ono" style="top:55%;left:1%;font-size:1.5rem;color:#82e2ff;transform:rotate(-12deg);text-shadow:0 0 15px rgba(130,226,255,0.4)" aria-hidden="true">&#9733;</span>
  <span class="punk-ono" style="bottom:6%;left:32%;font-size:1.25rem;color:#a277ff;transform:rotate(-8deg);text-shadow:0 0 10px rgba(162,119,255,0.5)" aria-hidden="true">POW!</span>

  <div class="hero-container">
    <div class="hero-grid">
      <!-- Left: Text content -->
      <div class="hero-content">
        <span class="hero-role hero-stagger" style="--stagger: 1">{t('hero.role', locale)}</span>
        <h1 class="hero-title hero-stagger punk-glitch" style="--stagger: 2">JoÃ£o<br />Bernardo</h1>
        <p class="hero-description hero-stagger" style="--stagger: 3">
          {t('hero.description', locale)}
        </p>
        <p class="hero-tech hero-stagger" style="--stagger: 4">{techString}</p>
      </div>

      <!-- Right: Stats -->
      <div class="hero-stats hero-stagger" style="--stagger: 5">
        {statsData.map((stat) => (
          <StatCard value={stat.value} suffix={stat.suffix} label={stat.label}>
            <StatsCounter client:visible value={stat.value} suffix={stat.suffix} />
          </StatCard>
        ))}
      </div>
    </div>

    <!-- MSN status bar (dark mode only) -->
    <div class="punk-msn-status" style="margin-top:1.5rem;max-width:320px" aria-hidden="true">
      Bernardo â€” online ðŸŽ¸ | msn messenger
    </div>
  </div>
</section>

<style is:global>
  .hero-section {
    position: relative;
    min-height: 90svh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    overflow: hidden;
  }

  /* Dark mode radial gradient */
  .dark .hero-section {
    background: radial-gradient(
      ellipse at 70% 20%,
      rgba(162, 119, 255, 0.08) 0%,
      transparent 60%
    );
  }

  .hero-container {
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
    padding: 2rem 1rem;
  }

  @media (min-width: 768px) {
    .hero-container {
      padding: 2rem 2rem;
    }
  }

  @media (min-width: 1024px) {
    .hero-container {
      padding: 2rem 4rem;
    }
  }

  .hero-grid {
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  @media (min-width: 768px) {
    .hero-grid {
      display: grid;
      grid-template-columns: 1.2fr 0.8fr;
      align-items: center;
      gap: 4rem;
    }
  }

  /* Hero content (left) */
  .hero-role {
    display: inline-block;
    font-family: var(--font-mono);
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--color-accent);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-bottom: 1rem;
  }

  .hero-title {
    font-family: var(--font-display);
    font-size: clamp(3rem, 8vw, 5.5rem);
    font-weight: 700;
    color: var(--color-text-primary);
    letter-spacing: -0.03em;
    line-height: 0.95;
    margin-bottom: 1.5rem;
  }

  .hero-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    line-height: 1.6;
    max-width: 500px;
    margin-bottom: 2rem;
  }

  /* Hero inline tech stack */
  .hero-tech {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--color-text-secondary);
    letter-spacing: 0.02em;
    opacity: 0.7;
  }

  /* Stats */
  .hero-stats {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
  }

  /* Mobile: horizontal with "|" separators */
  .stat-card + .stat-card {
    border-left: 1px solid var(--color-border);
    padding-left: 1.5rem;
    margin-left: 1.5rem;
  }

  /* Desktop: vertical stack */
  @media (min-width: 768px) {
    .hero-stats {
      flex-direction: column;
      align-items: flex-start;
      gap: 2rem;
    }
    .stat-card + .stat-card {
      border-left: none;
      padding-left: 0;
      margin-left: 0;
    }
  }

  /* Load stagger animation */
  .hero-stagger {
    opacity: 0;
    animation: fade-in-up 500ms cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
    animation-delay: calc(var(--stagger) * 100ms);
  }

  /* Reduced motion: hero elements must be visible */
  @media (prefers-reduced-motion: reduce) {
    .hero-stagger {
      opacity: 1 !important;
    }
  }

  /* Dark mode â€” punk hero */
  .dark .hero-title {
    font-family: var(--font-punk);
    text-shadow:
      0 0 30px rgba(162, 119, 255, 0.5),
      0 0 80px rgba(162, 119, 255, 0.2);
    transform: rotate(-1.5deg);
  }

  .dark .hero-role {
    color: #61ffca;
    text-shadow: 0 0 10px rgba(97, 255, 202, 0.3);
  }

  /* Mobile: sticker repositioning */
  @media (max-width: 767px) {
    .dark .hero-section .punk-sticker:first-of-type {
      width: 140px !important;
      top: -1% !important;
      right: -2% !important;
    }
    .dark .hero-section .punk-sticker:nth-of-type(2) {
      width: 60px !important;
      top: 2% !important;
      left: 0% !important;
    }
    .dark .hero-section .punk-sticker:nth-of-type(3) {
      width: 50px !important;
      bottom: 20% !important;
      left: 0% !important;
    }
    .dark .hero-title {
      transform: rotate(-0.5deg);
    }
  }

  /* Extra small screens (â‰¤480px) */
  @media (max-width: 480px) {
    .dark .hero-section .punk-sticker:first-of-type {
      width: 100px !important;
    }
    .dark .hero-section .punk-sticker:nth-of-type(2),
    .dark .hero-section .punk-sticker:nth-of-type(3) {
      width: 40px !important;
    }
  }
</style>

---
import { t } from '../i18n/utils';

interface Props {
  locale?: string;
}

const { locale = 'pt-br' } = Astro.props;

const locales = [
  { code: 'pt-br', label: 'PT', fullName: 'Português', path: '/' },
  { code: 'en', label: 'EN', fullName: 'English', path: '/en/' },
  { code: 'es', label: 'ES', fullName: 'Español', path: '/es/' },
];

const current = locales.find((l) => l.code === locale) ?? locales[0];
const others = locales.filter((l) => l.code !== locale);
---

<details class="lang-switcher" aria-label={t('language.switch', locale)}>
  <summary class="lang-trigger" aria-haspopup="true">
    <span class="lang-current">{current.label}</span>
    <span class="lang-chevron" aria-hidden="true">▾</span>
  </summary>
  <ul class="lang-dropdown" role="list">
    {others.map((l) => (
      <li>
        <a href={l.path} class="lang-option" hreflang={l.code === 'pt-br' ? 'pt-BR' : l.code} aria-label={l.fullName}>
          {l.label}
        </a>
      </li>
    ))}
  </ul>
</details>
